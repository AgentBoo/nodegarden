"use strict";!function(){function t(t,e){return null!=t?t:e}function e(t){this.garden=t,this.reset()}function i(t){this.nodes=[],this.container=t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#000000",this.started=!1,1!==s&&(this.canvas.style.transform="scale("+1/s+")",this.canvas.style.transformOrigin="0 0"),this.canvas.style.position="absolute",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.id="nodegarden";var i=new e(this);i.m=15,i.getDiameter=function(){return.1},i.update=function(){},i.reset=function(){},i.render=function(){},i.x=Number.MAX_SAFE_INTEGER,i.y=Number.MAX_SAFE_INTEGER,document.addEventListener("mousemove",function(t){i.x=t.pageX,i.y=t.pageY}),document.documentElement.addEventListener("mouseleave",function(t){i.x=Number.MAX_SAFE_INTEGER,i.y=Number.MAX_SAFE_INTEGER}),this.nodes.push(i),this.resize(),this.container.appendChild(this.canvas)}e.prototype.reset=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=e.x,s=e.y,n=e.vx,h=e.vy,o=e.m;this.x=t(i,Math.random()*this.garden.width),this.y=t(s,Math.random()*this.garden.height),this.vx=t(n,1*Math.random()-.5),this.vy=t(h,1*Math.random()-.5),this.m=t(o,2*Math.random()+1)},e.prototype.addForce=function(t,e){this.vx+=t*e.x/this.m,this.vy+=t*e.y/this.m},e.prototype.distanceTo=function(t){var e=t.x-this.x,i=t.y-this.y,s=Math.sqrt(Math.pow(e,2)+Math.pow(i,2));return{x:e,y:i,total:s}},e.prototype.update=function(){this.x+=this.vx,this.y+=this.vy,(this.x>this.garden.width+50||this.x<-50||this.y>this.garden.height+50||this.y<-50)&&this.reset()},e.prototype.squaredDistanceTo=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},e.prototype.collideTo=function(t){t.vx=t.m*t.vx/(this.m+t.m)+this.m*this.vx/(this.m+t.m),t.vy=t.m*t.vy/(this.m+t.m)+this.m*this.vy/(this.m+t.m),this.reset()},e.prototype.render=function(){this.garden.ctx.beginPath(),this.garden.ctx.arc(this.x,this.y,this.getDiameter(),0,2*Math.PI),this.garden.ctx.fill()},e.prototype.getDiameter=function(){return this.m};var s=window.devicePixelRatio;i.prototype.start=function(){this.playing||(this.playing=!0,this.render(!0))},i.prototype.stop=function(){this.playing&&(this.playing=!1)},i.prototype.resize=function(){this.width=window.innerWidth*s,this.height=window.innerHeight*s,this.area=this.width*this.height;var t=(Math.sqrt(this.area)/25|0)-this.nodes.length;if(this.canvas.width=this.width,this.canvas.height=this.height,!(0>t))for(var i=0;t>i;i++)this.nodes.push(new e(this))},i.prototype.isNightMode=function(){return document.body.classList.contains("nightmode")},i.prototype.toggleNightMode=function(){document.body.classList.toggle("nightmode"),this.isNightMode()?this.ctx.fillStyle="#ffffff":this.ctx.fillStyle="#000000"},i.prototype.render=function(t){var e=this;if(this.playing){t&&requestAnimationFrame(function(){e.render(!0)}),this.ctx.clearRect(0,0,this.width,this.height);for(var i,s,n=0;n<this.nodes.length-1;n++){i=this.nodes[n];for(var h=n+1;h<this.nodes.length;h++){s=this.nodes[h];var o=i.squaredDistanceTo(s),a=3*(i.m*s.m)/o,r=100*a;if(!(.05>r))if(o<=(i.getDiameter()/2+s.getDiameter()/2)*(i.getDiameter()/2+s.getDiameter()/2))i.m<=s.m?i.collideTo(s):s.collideTo(i);else{var d=i.distanceTo(s),c={x:d.x/d.total,y:d.y/d.total};this.ctx.beginPath(),this.isNightMode()?this.ctx.strokeStyle="rgba(191,191,191,"+(1>r?r:1)+")":this.ctx.strokeStyle="rgba(63,63,63,"+(1>r?r:1)+")",this.ctx.moveTo(i.x,i.y),this.ctx.lineTo(s.x,s.y),this.ctx.stroke(),i.addForce(a,c),s.addForce(-a,c)}}}for(var n=0;n<this.nodes.length;n++)this.nodes[n].render(),this.nodes[n].update()}};var n=document.getElementById("container"),h=document.getElementsByClassName("moon")[0],o=new i(n);o.start();var a=new Date;(a.getHours()>18||a.getHours()<6)&&o.toggleNightMode(),n.addEventListener("click",function(t){var i=new e(o),s=2*Math.random()*Math.PI;i.reset({x:t.pageX+100*Math.cos(s),y:t.pageY+100*Math.sin(s)}),o.nodes.push(i),console.log(o.nodes.length)}),h.addEventListener("click",function(){o.toggleNightMode()}),window.addEventListener("resize",function(){o.resize()})}();