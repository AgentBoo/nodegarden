!function(){"use strict";function h(t,e){return null!=t?t:e}var e=1e3/60,o=function(t){this.garden=t,this.reset()};o.prototype.reset=function(t){void 0===t&&(t={});var e=t.x,i=t.y,n=t.vx,s=t.vy,o=t.m;this.x=h(e,Math.random()*this.garden.width),this.y=h(i,Math.random()*this.garden.height),this.vx=h(n,.5*Math.random()-.25),this.vy=h(s,.5*Math.random()-.25),this.m=h(o,2.5*Math.random()+.5)},o.prototype.addForce=function(t,e){this.vx+=t*e.x/this.m,this.vy+=t*e.y/this.m},o.prototype.distanceTo=function(t){var e=t.x-this.x,i=t.y-this.y;return{x:e,y:i,total:Math.sqrt(Math.pow(e,2)+Math.pow(i,2))}},o.prototype.update=function(t){this.x+=this.vx*t/e,this.y+=this.vy*t/e,(this.x>this.garden.width+50||this.x<-50||this.y>this.garden.height+50||this.y<-50)&&this.reset()},o.prototype.squaredDistanceTo=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},o.prototype.collideTo=function(t){t.vx=t.m*t.vx/(this.m+t.m)+this.m*this.vx/(this.m+t.m),t.vy=t.m*t.vy/(this.m+t.m)+this.m*this.vy/(this.m+t.m),this.reset()},o.prototype.render=function(){this.garden.ctx.beginPath(),this.garden.ctx.arc(this.x,this.y,this.getDiameter(),0,2*Math.PI),this.garden.ctx.fill()},o.prototype.getDiameter=function(){return this.m};var a=window.devicePixelRatio;void 0===a&&(a=1);var v=window.requestAnimationFrame,t=function(n){var s=this;this.nodes=[],this.container=n,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.started=!1,this.nightmode=!1,a&&1!==a&&(this.canvas.style.transform="scale("+1/a+")",this.canvas.style.transformOrigin="0 0"),this.canvas.id="nodegarden",window.addEventListener("mousedown",function(t){var e=n.getBoundingClientRect(),i=new o(s);i.x=(t.pageX-e.left)*a,i.y=(t.pageY-e.top)*a,i.m=15,i.update=function(){},i.reset=function(){},i.render=function(){},s.nodes.unshift(i),window.addEventListener("mousemove",function(t){i.x=(t.pageX-e.left)*a,i.y=(t.pageY-e.top)*a}),window.addEventListener("mouseup",function(t){for(var e=0;e<s.nodes.length;e++)if(s.nodes[e]===i){s.nodes.splice(e--,1);break}})}),this.container.appendChild(this.canvas),this.resize()};t.prototype.start=function(){this.playing||(this.playing=!0,this.render(!0))},t.prototype.stop=function(){this.playing&&(this.playing=!1)},t.prototype.resize=function(){var t=this;this.width=this.container.clientWidth*a,this.height=this.container.clientHeight*a,this.area=this.width*this.height,this.nodes.length=Math.sqrt(this.area)/25|0,this.canvas.width=this.width,this.canvas.height=this.height,this.nightMode?this.ctx.fillStyle="#ffffff":this.ctx.fillStyle="#000000";for(var e=0;e<this.nodes.length;e++)t.nodes[e]||(t.nodes[e]=new o(t))},t.prototype.toggleNightMode=function(){this.nightMode=!this.nightMode,this.nightMode?(this.ctx.fillStyle="#ffffff",document.body.classList.add("nightmode")):(this.ctx.fillStyle="#000000",document.body.classList.remove("nightmode"))},t.prototype.render=function(t,e){var i=this;if(this.playing){t&&v(function(t){i.render(!0,t)});var n=e-(this.lastTime||e);this.lastTime=e,this.ctx.clearRect(0,0,this.width,this.height);for(var s=0;s<this.nodes.length-1;s++)for(var o=i.nodes[s],h=s+1;h<this.nodes.length;h++){var a=i.nodes[h],r=o.squaredDistanceTo(a),d=o.m*a.m*3/r,c=100*d;if(!(c<.025))if(r<=(o.m/2+a.m/2)*(o.m/2+a.m/2))o.m<=a.m?o.collideTo(a):a.collideTo(o);else{var l=o.distanceTo(a),g={x:l.x/l.total,y:l.y/l.total};i.ctx.beginPath(),i.nightMode?i.ctx.strokeStyle="rgba(191,191,191,"+(c<1?c:1)+")":i.ctx.strokeStyle="rgba(63,63,63,"+(c<1?c:1)+")",i.ctx.moveTo(o.x,o.y),i.ctx.lineTo(a.x,a.y),i.ctx.stroke(),o.addForce(d,g),a.addForce(-d,g)}}for(var f=0;f<this.nodes.length;f++)i.nodes[f].render(),i.nodes[f].update(n||0)}};var i=window.devicePixelRatio,n=document.getElementById("container"),s=document.getElementsByClassName("moon")[0],r=new t(n);r.start();var d=new Date;(18<d.getHours()||d.getHours()<6)&&r.toggleNightMode();var c=0;n.addEventListener("click",function(t){var e=n.getBoundingClientRect();++c>r.nodes.length-1&&(c=1),r.nodes[c].reset({x:(t.pageX-e.left)*i,y:(t.pageY-e.top)*i,vx:0,vy:0})}),s.addEventListener("click",function(){r.toggleNightMode()}),window.addEventListener("resize",function(){r.resize()})}();